<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/js/bootstrap.bundle.min.js" integrity="sha384-FKyoEForCGlyvwx9Hj09JcYn3nv7wiPVlz7YYwJrWVcXK/BmnVDxM+D2scQbITxI" crossorigin="anonymous"></script>

<script>
document.addEventListener("DOMContentLoaded", () => {
  const input = document.getElementById("searchInput");
  const suggestionsBox = document.getElementById("suggestionsBox");

  let debounceTimer;

  input.addEventListener("input", () => {
    clearTimeout(debounceTimer);
    const query = input.value.trim();

    if (!query) {
      suggestionsBox.innerHTML = "";
      return;
    }

    debounceTimer = setTimeout(async () => {
      const res = await fetch(`/search/suggestions?q=${encodeURIComponent(query)}`);
      const blogs = await res.json();

      suggestionsBox.innerHTML = "";
      if (blogs.length > 0) {
        blogs.forEach(blog => {
          const item = document.createElement("a");
          item.href = `/blog/${blog._id}`;
          item.className = "list-group-item list-group-item-action";
          item.textContent = blog.title;
          suggestionsBox.appendChild(item);
        });
      } else {
        suggestionsBox.innerHTML = `<div class="list-group-item text-muted">No blogs found</div>`;
      }
    }, 300); // debounce 300ms
  });

  
  document.addEventListener("click", (e) => {
    if (!e.target.closest("#searchForm")) suggestionsBox.innerHTML = "";
  });
});
</script>
